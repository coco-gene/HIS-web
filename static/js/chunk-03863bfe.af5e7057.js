(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-03863bfe"],{"09f4":function(e,t,i){"use strict";i.d(t,"a",(function(){return o})),Math.easeInOutQuad=function(e,t,i,a){return e/=a/2,e<1?i/2*e*e+t:(e--,-i/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function n(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function o(e,t,i){var o=l(),r=e-o,s=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=s;var l=Math.easeInOutQuad(u,o,r,t);n(l),u<t?a(e):i&&"function"===typeof i&&i()};c()}},"1e0f":function(e,t,i){"use strict";i.d(t,"e",(function(){return n})),i.d(t,"d",(function(){return l})),i.d(t,"c",(function(){return o})),i.d(t,"g",(function(){return r})),i.d(t,"b",(function(){return s})),i.d(t,"a",(function(){return u})),i.d(t,"f",(function(){return c}));var a=i("b775");function n(e){return Object(a["a"])({url:"/drug/selectDrug",method:"post",params:e})}function l(){return Object(a["a"])({url:"/drug/selectAllDrug",method:"get"})}function o(){return Object(a["a"])({url:"/drug/selectAllDosage",method:"get"})}function r(e){return Object(a["a"])({url:"/drug/updateDrug/"+e.id,method:"post",data:e})}function s(e){return Object(a["a"])({url:"/drug/deleteDrug",method:"post",params:{ids:e}})}function u(e){return Object(a["a"])({url:"/drug/createDrug",method:"post",data:e})}function c(e){return Object(a["a"])({url:"/drug/selectById",method:"get",params:{id:e}})}},"39f5":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"div1"},[i("el-container",[i("transition",{attrs:{name:"el-zoom-in-left"}},[i("el-aside",{staticStyle:{"margin-top":"0",background:"white",padding:"0 0 0 0"},attrs:{width:e.asidewidth}},[i("aside",{staticStyle:{height:"50px",margin:"0 0 0 0"}},[i("el-tag",{attrs:{size:"large"}},[e._v("药品模板")])],1),e._v(" "),i("div",{staticStyle:{padding:"0 10px 0 10px"}},[e.isaside?e._e():i("el-card",[i("el-form",{staticStyle:{background:"white"},attrs:{model:e.listQuery,inline:""}},[i("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"模板名称:"}},[i("el-input",{attrs:{placeholder:"模板名称"},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}})],1),e._v(" "),i("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"范围:"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"请选择范围",clearable:""},model:{value:e.listQuery.scope,callback:function(t){e.$set(e.listQuery,"scope",t)},expression:"listQuery.scope"}},e._l([{key:0,value:"个人"},{key:1,value:"科室"},{key:2,value:"全院"}],(function(e){return i("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})})),1)],1),e._v(" "),i("el-form-item",{staticStyle:{width:"400px"}},[e.isaside?e._e():i("el-button",{attrs:{type:"primary"},on:{click:e.searchModel}},[e._v("搜索模板")]),e._v(" "),e.isaside?e._e():i("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.showaside("add")}}},[e._v("新建模板")])],1)],1)],1),e._v(" "),i("div",{staticStyle:{background:"white"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.modelList,stripe:"",border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"模板编号",prop:"id",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.id)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板名称",prop:"name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.name)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板简介",prop:"aim"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.aim)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"模版编码",prop:"code"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n            "+e._s(t.row.code)+"\n          ")]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"范围",prop:"scope",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.scope?i("span",[e._v("个人")]):e._e(),e._v(" "),1===t.row.scope?i("span",[e._v("科室")]):e._e(),e._v(" "),2===t.row.scope?i("span",[e._v("全院")]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板类型",prop:"type",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.type?i("span",[e._v("成药模板")]):e._e(),e._v(" "),2===t.row.type?i("span",[e._v("草药模板")]):e._e()]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"id",width:"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return e.editModel(t.row)}}},[e._v("修改")]),e._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return e.deleteModel(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.pageNum,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNum",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getModelList}})],1)],1)])],1),e._v(" "),e.isaside?i("el-main",{staticStyle:{padding:"0 0 0 0"}},[e.edit?i("el-button",{staticStyle:{"margin-left":"30px","margin-top":"30px","margin-bottom":"30px"},attrs:{type:"primary"},on:{click:e.updateModel}},[e._v("提交修改")]):e._e(),e._v(" "),e.edit?e._e():i("el-button",{staticStyle:{"margin-left":"30px","margin-top":"30px","margin-bottom":"30px"},attrs:{type:"primary"},on:{click:e.createModel}},[e._v("新建模板")]),e._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:e.showaside}},[e._v("取消")]),e._v(" "),i("el-form",{attrs:{model:e.model,"label-width":"140px",inline:""}},[i("el-form-item",{attrs:{label:"模板名称"}},[i("el-input",{attrs:{placeholder:"请输入模板名称"},model:{value:e.model.name,callback:function(t){e.$set(e.model,"name",t)},expression:"model.name"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"模板简介"}},[i("el-input",{attrs:{placeholder:"模板简介"},model:{value:e.model.aim,callback:function(t){e.$set(e.model,"aim",t)},expression:"model.aim"}})],1),e._v(" "),e.edit?i("el-form-item",{attrs:{label:"模板编码"}},[i("el-input",{attrs:{placeholder:"模板编码",disabled:""},model:{value:e.model.code,callback:function(t){e.$set(e.model,"code",t)},expression:"model.code"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"嘱托"}},[i("el-input",{attrs:{placeholder:"嘱托"},model:{value:e.model.medicalAdvice,callback:function(t){e.$set(e.model,"medicalAdvice",t)},expression:"model.medicalAdvice"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"治法"}},[i("el-input",{attrs:{placeholder:"治法"},model:{value:e.model.therapy,callback:function(t){e.$set(e.model,"therapy",t)},expression:"model.therapy"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"用法"}},[i("el-input",{attrs:{placeholder:"用法"},model:{value:e.model.frequency,callback:function(t){e.$set(e.model,"frequency",t)},expression:"model.frequency"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"付数"}},[i("el-input",{attrs:{placeholder:"付数"},model:{value:e.model.pairNum,callback:function(t){e.$set(e.model,"pairNum",t)},expression:"model.pairNum"}})],1),e._v(" "),e.edit?i("el-form-item",{attrs:{label:"创建时间"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"",disabled:""},model:{value:e.model.createTime,callback:function(t){e.$set(e.model,"createTime",t)},expression:"model.createTime"}})],1):e._e(),e._v(" "),i("el-form-item",{attrs:{label:"模板范围"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"请选择范围",clearable:""},model:{value:e.model.scope,callback:function(t){e.$set(e.model,"scope",t)},expression:"model.scope"}},e._l([{key:0,value:"个人"},{key:1,value:"科室"},{key:2,value:"全院"}],(function(e){return i("el-option",{key:e.key,attrs:{label:e.value,value:e.key}})})),1)],1)],1),e._v(" "),i("el-button",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},attrs:{type:"primary"},on:{click:e.addItem}},[e._v("编辑项目")]),e._v(" "),i("el-table",{staticStyle:{"margin-bottom":"50px"},attrs:{data:e.itemdrugList,stripe:"",border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"药品名",prop:"name",width:"330px"}}),e._v(" "),i("el-table-column",{attrs:{label:"药品规格",prop:"format",width:"200px"}}),e._v(" "),i("el-table-column",{attrs:{label:"药品单价(元)",prop:"price",width:"70px"}}),e._v(" "),i("el-table-column",{attrs:{label:"药品数量",prop:"num",width:"70px"}}),e._v(" "),i("el-table-column",{attrs:{label:"总价",prop:"totalprice",width:"70px"}}),e._v(" "),i("el-table-column",{attrs:{label:"拼音码",prop:"mnemonicCode"}}),e._v(" "),i("el-table-column",{attrs:{label:"使用建议",prop:"medicalAdvice"}}),e._v(" "),i("el-table-column",{attrs:{label:"频次",prop:"frequency"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.frequency?i("span",[e._v("一天一次")]):e._e(),e._v(" "),2===t.row.frequency?i("span",[e._v("一天三次")]):e._e()]}}],null,!1,3755346362)}),e._v(" "),i("el-table-column",{attrs:{label:"天数",prop:"days"}}),e._v(" "),i("el-table-column",{attrs:{label:"用量",prop:"usageNum"}}),e._v(" "),i("el-table-column",{attrs:{label:"单位",prop:"usageNumUnit"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.usageNumUnit?i("span",[e._v("片")]):e._e(),e._v(" "),2===t.row.usageNumUnit?i("span",[e._v("支")]):e._e(),e._v(" "),3===t.row.usageNumUnit?i("span",[e._v("瓶")]):e._e(),e._v(" "),4===t.row.usageNumUnit?i("span",[e._v("克")]):e._e()]}}],null,!1,1165538273)})],1)],1):e._e()],1),e._v(" "),i("el-dialog",{attrs:{title:"增加药品",visible:e.dialogVisible,width:"1500px",top:"10px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[i("el-container",[i("el-aside",{staticStyle:{padding:"0 0 0 0",margin:"0 0 0 0"},attrs:{width:"30%"}},[i("el-tag",{staticStyle:{width:"100%",height:"30px"},attrs:{type:"primary"}},[e._v("药品目录\n          "),i("el-button",{staticStyle:{width:"20px",float:"right"},attrs:{type:"primary",size:"mini"}},[i("svg-icon",{staticStyle:{"margin-left":"-6px"},attrs:{"icon-class":"search"}})],1),e._v(" "),i("el-input",{staticStyle:{width:"60%",float:"right"},attrs:{size:"mini",placeholder:"药品名称"},on:{change:function(t){return e.getdrugList(0)}},model:{value:e.searchdrug,callback:function(t){e.searchdrug=t},expression:"searchdrug"}})],1),e._v(" "),i("el-table",{attrs:{data:e.drugList,height:"500px"},on:{"row-click":e.choosedrug}},[i("el-table-column",{attrs:{label:"药品名",prop:"name"}}),e._v(" "),i("el-table-column",{attrs:{label:"价格(元)",prop:"price",width:"100px"}})],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total2>0,expression:"total2>0"}],staticStyle:{"margin-top":"0px"},attrs:{layout:"prev, pager, next","auto-scroll":"false","page-sizes":"[]",total:e.total2,page:e.page.pageNum,limit:e.page.pageSize},on:{"update:page":function(t){return e.$set(e.page,"pageNum",t)},"update:limit":function(t){return e.$set(e.page,"pageSize",t)},pagination:function(t){return e.getdrugList(0)}}}),e._v(" "),i("div")],1),e._v(" "),i("el-main",[i("el-tag",{attrs:{type:"primary"}},[e._v("项目金额总计:")]),e._v(" "),i("el-tag",{attrs:{type:"warning"}},[e._v(e._s(e.oneprescription.amount)+"元")]),e._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:e.addDrug}},[e._v("确定")]),e._v(" "),i("el-table",{attrs:{height:"500px",data:e.oneprescription.druglist,"cell-style":"text-align:center","header-cell-style":"text-align:center"}},[i("el-table-column",{attrs:{width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return e.deldrug(t.row)}}},[e._v("删除")])]}}])}),e._v(" "),i("el-table-column",{attrs:{property:"name",label:"药品名",width:"150"}}),e._v(" "),i("el-table-column",{attrs:{property:"format",label:"规格",width:"200"}}),e._v(" "),i("el-table-column",{attrs:{property:"price",label:"单价"}}),e._v(" "),i("el-table-column",{attrs:{label:"数量",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right",min:1,max:100,size:"mini"},on:{change:function(i){return e.changenum(t.row)}},model:{value:t.row.num,callback:function(i){e.$set(t.row,"num",i)},expression:"scope.row.num"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"剂型",width:"130px",prop:"dosage.name"}}),e._v(" "),i("el-table-column",{attrs:{label:"医嘱",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{placeholder:"医嘱"},model:{value:t.row.medicalAdvice,callback:function(i){e.$set(t.row,"medicalAdvice",i)},expression:"scope.row.medicalAdvice"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"脚注",width:"130"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{placeholder:"脚注"},model:{value:t.row.footnote,callback:function(i){e.$set(t.row,"footnote",i)},expression:"scope.row.footnote"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"频次",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:""},model:{value:t.row.frequency,callback:function(i){e.$set(t.row,"frequency",i)},expression:"scope.row.frequency"}},e._l([{key:1,label:"一天一次"},{key:2,label:"一天三次"}],(function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"用量",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-input",{attrs:{placeholder:""},model:{value:t.row.usageNum,callback:function(i){e.$set(t.row,"usageNum",i)},expression:"scope.row.usageNum"}})]}}])}),e._v(" "),i("el-table-column",{attrs:{label:"单位",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:""},model:{value:t.row.usageNumUnit,callback:function(i){e.$set(t.row,"usageNumUnit",i)},expression:"scope.row.usageNumUnit"}},e._l([{key:1,label:"片"},{key:2,label:"支"},{key:3,label:"瓶"},{key:2,label:"克"}],(function(e){return i("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)]}}])})],1)],1)],1)],1)],1)},n=[],l=(i("a450"),i("4057"),i("aa18"),i("982e"),i("e186"),i("c6da")),o=(i("1bc7"),i("efa4")),r=i("1e0f"),s=i("333d"),u=i("ed08"),c={components:{Pagination:s["a"]},data:function(){return{page:{pageNum:1,pageSize:10},oneprescription:{name:"",druglist:[],amount:0,status:0},itemdrugList:[],drugList:[],searchdrug:"",choices:[],dialogVisible:!1,alldrugList:[],nondrugList:[],edit:0,model:{},total2:0,loading:!1,isaside:!1,asidewidth:"100%",total:0,listQuery:{id:"",status:1,name:"",scope:0,ownId:this.$store.getters.id,aim:"",code:"",type:2,pageSize:20,pageNum:1,isAdmin:"0"},modelList:[],queryModel:{name:"",range:"",type:""}}},created:function(){this.getModelList()},methods:{addDrug:function(){this.dialogVisible=!1,this.itemdrugList=this.oneprescription.druglist,this.itemdrugList.forEach((function(e){e.totalprice=Math.floor(e.price*e.num*100)/100}))},getdrugList:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i={},i.pageSize=this.page.pageSize,i.pageNum=this.page.pageNum,i.typeId=103,i.name=this.searchdrug,e.next=7,Object(r["e"])(i);case 7:a=e.sent,this.drugList=a.data.list,this.total2=a.data.total;case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),deldrug:function(e){var t=this;this.oneprescription.druglist=this.oneprescription.druglist.filter((function(t){return t.id!==e.id})),this.oneprescription.amount=0,this.oneprescription.druglist.forEach((function(e){t.oneprescription.amount+=e.price})),this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100},choosedrug:function(e){var t=1;this.oneprescription.druglist.forEach((function(i){i.id===e.id&&(i.num+=1,t=0)})),t&&(this.oneprescription.amount+=e.price,this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100,this.oneprescription.druglist.push(e),this.oneprescription.druglist.forEach((function(e){void 0===e.num&&(e.num=1)})))},deleteModel:function(e){var t=this;this.$confirm("确认删除当前模板?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])(e.id).then((function(e){t.getModelList(),t.$notify({title:"成功",message:e.message,type:"success",duration:2e3})}))}))},createModel:function(){var e=this,t=Object(u["c"])(this.model);t.status=1,t.ownId=this.$store.getters.id,t.dmsMedicineModelItemList=Object(u["c"])(this.itemdrugList),t.type=2,Object(o["a"])(t).then((function(t){e.getModelList(),e.$notify({title:"成功",message:t.message,type:"success",duration:2e3})})),this.showaside()},updateModel:function(){var e=this,t=Object(u["c"])(this.model);t.nonDrugIdList=Object(u["c"])(this.choices),Object(o["d"])(t).then((function(t){e.getModelList(),e.$notify({title:"成功",message:t.message,type:"success",duration:2e3})})),this.showaside()},confirmItem:function(){var e=this;this.nondrugList=this.alldrugList.filter((function(t){if(e.choices.includes(t.id))return!0})),this.dialogVisible=!this.dialogVisible},addItem:function(){this.dialogVisible=!0,this.getdrugList()},getAllNondrug:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){var e=this;getAllNondrug().then((function(t){e.alldrugList=t.data,e.alldrugList.forEach((function(e){e.label=e.name,e.key=e.id}))}))})),getModelList:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Object(o["c"])(this.listQuery).then((function(e){t.modelList=e.data.list,t.total=e.data.total,t.modelList.forEach((function(e){e.dmsMedicineModelItemList.forEach((function(e){Object(r["f"])(e.id).then((function(t){e.name=t.data.name,e.format=t.data.format,e.price=t.data.price,e.totalprice=e.price*e.num,e.mnemonicCode=t.data.mnemonicCode}))})),e.createTime=Object(u["f"])(e.createTime)})),t.total=e.data.total}));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),searchModel:function(){this.loading=!0,this.getModelList(),this.loading=!1},showaside:function(e){"100%"===this.asidewidth?this.asidewidth="0%":this.asidewidth="100%",this.isaside=!this.isaside,"edit"===e?this.edit=1:"add"===e?(this.choices=[],this.nondrugList=[],this.itemdrugList=[],this.model={},this.edit=0):this.edit=0},editModel:function(e){this.itemdrugList=e.dmsMedicineModelItemList,this.model=Object(u["c"])(e),this.model.createTime=Object(u["f"])(this.model.createTime),this.showaside("edit")}}},d=c,p=(i("b03e"),i("cba8")),m=Object(p["a"])(d,a,n,!1,null,null,null);t["default"]=m.exports},b03e:function(e,t,i){"use strict";i("bdde")},bdde:function(e,t,i){},efa4:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return o})),i.d(t,"d",(function(){return r}));var a=i("b775");function n(e){return Object(a["a"])({url:"/drugModel/createModel",method:"post",data:e})}function l(e){return Object(a["a"])({url:"/drugModel/deleteModel",method:"post",params:{ids:e}})}function o(e){return Object(a["a"])({url:"/drugModel/listModel",method:"get",params:e})}function r(e){return Object(a["a"])({url:"/drugModel/updateModel",method:"post",params:{modelId:e.id},data:e})}}}]);