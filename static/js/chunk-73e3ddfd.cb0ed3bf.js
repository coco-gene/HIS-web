(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-73e3ddfd"],{"09f4":function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),Math.easeInOutQuad=function(t,e,i,n){return t/=n/2,t<1?i/2*t*t+e:(t--,-i/2*(t*(t-2)-1)+e)};var n=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function a(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(t,e,i){var r=l(),o=t-r,s=20,u=0;e="undefined"===typeof e?500:e;var c=function t(){u+=s;var l=Math.easeInOutQuad(u,r,o,e);a(l),u<e?n(t):i&&"function"===typeof i&&i()};c()}},"1e0f":function(t,e,i){"use strict";i.d(e,"e",(function(){return a})),i.d(e,"d",(function(){return l})),i.d(e,"c",(function(){return r})),i.d(e,"g",(function(){return o})),i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return u})),i.d(e,"f",(function(){return c}));var n=i("b775");function a(t){return Object(n["a"])({url:"/drug/selectDrug",method:"post",params:t})}function l(){return Object(n["a"])({url:"/drug/selectAllDrug",method:"get"})}function r(){return Object(n["a"])({url:"/drug/selectAllDosage",method:"get"})}function o(t){return Object(n["a"])({url:"/drug/updateDrug/"+t.id,method:"post",data:t})}function s(t){return Object(n["a"])({url:"/drug/deleteDrug",method:"post",params:{ids:t}})}function u(t){return Object(n["a"])({url:"/drug/createDrug",method:"post",data:t})}function c(t){return Object(n["a"])({url:"/drug/selectById",method:"get",params:{id:t}})}},"45a7":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"div1"},[i("el-container",[i("transition",{attrs:{name:"el-zoom-in-left"}},[i("el-aside",{staticStyle:{"margin-top":"0",background:"white",padding:"0 0 0 0"},attrs:{width:t.asidewidth}},[i("aside",{staticStyle:{height:"50px",margin:"0 0 0 0"}},[i("el-tag",{attrs:{size:"large"}},[t._v("药品模板")])],1),t._v(" "),i("div",{staticStyle:{padding:"0 10px 0 10px"}},[t.isaside?t._e():i("el-card",[i("el-form",{staticStyle:{background:"white"},attrs:{model:t.listQuery,inline:""}},[i("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"模板名称:"}},[i("el-input",{attrs:{placeholder:"模板名称"},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}})],1),t._v(" "),i("el-form-item",{staticStyle:{width:"280px"},attrs:{label:"范围:"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"请选择范围",clearable:""},model:{value:t.listQuery.scope,callback:function(e){t.$set(t.listQuery,"scope",e)},expression:"listQuery.scope"}},t._l([{key:0,value:"个人"},{key:1,value:"科室"},{key:2,value:"全院"}],(function(t){return i("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),t._v(" "),i("el-form-item",{staticStyle:{width:"400px"}},[t.isaside?t._e():i("el-button",{attrs:{type:"primary"},on:{click:t.searchModel}},[t._v("搜索模板")]),t._v(" "),t.isaside?t._e():i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showaside("add")}}},[t._v("新建模板")])],1)],1)],1),t._v(" "),i("div",{staticStyle:{background:"white"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.modelList,stripe:"",border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"模板编号",prop:"id",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.id)+"\n          ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板名称",prop:"name"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.name)+"\n          ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板简介",prop:"aim"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.aim)+"\n          ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"模版编码",prop:"code"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n            "+t._s(e.row.code)+"\n          ")]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"范围",prop:"scope",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.scope?i("span",[t._v("个人")]):t._e(),t._v(" "),1===e.row.scope?i("span",[t._v("科室")]):t._e(),t._v(" "),2===e.row.scope?i("span",[t._v("全院")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"模板类型",prop:"type",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.type?i("span",[t._v("成药模板")]):t._e(),t._v(" "),2===e.row.type?i("span",[t._v("草药模板")]):t._e()]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",prop:"id",width:"150px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(i){return t.editModel(e.row)}}},[t._v("修改")]),t._v(" "),i("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(i){return t.deleteModel(e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.listQuery.pageNum,limit:t.listQuery.pageSize},on:{"update:page":function(e){return t.$set(t.listQuery,"pageNum",e)},"update:limit":function(e){return t.$set(t.listQuery,"pageSize",e)},pagination:t.getModelList}})],1)],1)])],1),t._v(" "),t.isaside?i("el-main",{staticStyle:{padding:"0 0 0 0"}},[t.edit?i("el-button",{staticStyle:{"margin-left":"30px","margin-top":"30px","margin-bottom":"30px"},attrs:{type:"primary"},on:{click:t.updateModel}},[t._v("提交修改")]):t._e(),t._v(" "),t.edit?t._e():i("el-button",{staticStyle:{"margin-left":"30px","margin-top":"30px","margin-bottom":"30px"},attrs:{type:"primary"},on:{click:t.createModel}},[t._v("新建模板")]),t._v(" "),i("el-button",{attrs:{type:"danger"},on:{click:t.showaside}},[t._v("取消")]),t._v(" "),i("el-form",{attrs:{model:t.model,"label-width":"140px",inline:""}},[i("el-form-item",{attrs:{label:"模板名称"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"请输入模板名称"},model:{value:t.model.name,callback:function(e){t.$set(t.model,"name",e)},expression:"model.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"模板简介"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"模板简介"},model:{value:t.model.aim,callback:function(e){t.$set(t.model,"aim",e)},expression:"model.aim"}})],1),t._v(" "),t.edit?i("el-form-item",{attrs:{label:"模板编码"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"模板编码",disabled:""},model:{value:t.model.code,callback:function(e){t.$set(t.model,"code",e)},expression:"model.code"}})],1):t._e(),t._v(" "),t.edit?i("el-form-item",{attrs:{label:"创建时间"}},[i("el-input",{staticStyle:{width:"300px"},attrs:{placeholder:"",disabled:""},model:{value:t.model.createTime,callback:function(e){t.$set(t.model,"createTime",e)},expression:"model.createTime"}})],1):t._e(),t._v(" "),i("el-form-item",{attrs:{label:"模板范围"}},[i("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"请选择范围",clearable:""},model:{value:t.model.scope,callback:function(e){t.$set(t.model,"scope",e)},expression:"model.scope"}},t._l([{key:0,value:"个人"},{key:1,value:"科室"},{key:2,value:"全院"}],(function(t){return i("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1)],1),t._v(" "),i("el-button",{staticStyle:{"margin-bottom":"10px","margin-left":"10px"},attrs:{type:"primary"},on:{click:t.addItem}},[t._v("编辑项目")]),t._v(" "),i("el-table",{staticStyle:{"margin-bottom":"50px"},attrs:{data:t.itemdrugList,stripe:"",border:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"药品名",prop:"name",width:"330px"}}),t._v(" "),i("el-table-column",{attrs:{label:"药品规格",prop:"format",width:"200px"}}),t._v(" "),i("el-table-column",{attrs:{label:"药品单价(元)",prop:"price",width:"70px"}}),t._v(" "),i("el-table-column",{attrs:{label:"药品数量",prop:"num",width:"70px"}}),t._v(" "),i("el-table-column",{attrs:{label:"总价",prop:"totalprice",width:"70px"}}),t._v(" "),i("el-table-column",{attrs:{label:"拼音码",prop:"mnemonicCode",width:"200px"}}),t._v(" "),i("el-table-column",{attrs:{label:"使用建议",prop:"medicalAdvice"}}),t._v(" "),i("el-table-column",{attrs:{label:"频次",prop:"frequency"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.frequency?i("span",[t._v("一天一次")]):t._e(),t._v(" "),2===e.row.frequency?i("span",[t._v("一天三次")]):t._e()]}}],null,!1,3755346362)}),t._v(" "),i("el-table-column",{attrs:{label:"天数",prop:"days"}}),t._v(" "),i("el-table-column",{attrs:{label:"用量",prop:"usageNum"}}),t._v(" "),i("el-table-column",{attrs:{label:"单位",prop:"usageNumUnit"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.usageNumUnit?i("span",[t._v("片")]):t._e(),t._v(" "),2===e.row.usageNumUnit?i("span",[t._v("支")]):t._e(),t._v(" "),3===e.row.usageNumUnit?i("span",[t._v("瓶")]):t._e(),t._v(" "),4===e.row.usageNumUnit?i("span",[t._v("克")]):t._e()]}}],null,!1,1165538273)})],1)],1):t._e()],1),t._v(" "),i("el-dialog",{attrs:{title:"增加药品",visible:t.dialogVisible,width:"1500px",top:"10px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("el-container",[i("el-aside",{staticStyle:{padding:"0 0 0 0",margin:"0 0 0 0"},attrs:{width:"30%"}},[i("el-tag",{staticStyle:{width:"100%",height:"30px"},attrs:{type:"primary"}},[t._v("药品目录\n          "),i("el-button",{staticStyle:{width:"20px",float:"right"},attrs:{type:"primary",size:"mini"}},[i("svg-icon",{staticStyle:{"margin-left":"-6px"},attrs:{"icon-class":"search"}})],1),t._v(" "),i("el-input",{staticStyle:{width:"60%",float:"right"},attrs:{size:"mini",placeholder:"药品名称"},on:{change:function(e){return t.getdrugList(0)}},model:{value:t.searchdrug,callback:function(e){t.searchdrug=e},expression:"searchdrug"}})],1),t._v(" "),i("el-table",{attrs:{data:t.drugList,height:"500px"},on:{"row-click":t.choosedrug}},[i("el-table-column",{attrs:{label:"药品名",prop:"name"}}),t._v(" "),i("el-table-column",{attrs:{label:"价格(元)",prop:"price",width:"100px"}})],1),t._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total2>0,expression:"total2>0"}],staticStyle:{"margin-top":"0px"},attrs:{layout:"prev, pager, next","auto-scroll":"false","page-sizes":"[]",total:t.total2,page:t.page.pageNum,limit:t.page.pageSize},on:{"update:page":function(e){return t.$set(t.page,"pageNum",e)},"update:limit":function(e){return t.$set(t.page,"pageSize",e)},pagination:function(e){return t.getdrugList(0)}}}),t._v(" "),i("div")],1),t._v(" "),i("el-main",[i("el-tag",{attrs:{type:"primary"}},[t._v("项目金额总计:")]),t._v(" "),i("el-tag",{attrs:{type:"warning"}},[t._v(t._s(t.oneprescription.amount)+"元")]),t._v(" "),i("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.addDrug}},[t._v("确定")]),t._v(" "),i("el-table",{attrs:{height:"500px",data:t.oneprescription.druglist,"cell-style":"text-align:center","header-cell-style":"text-align:center"}},[i("el-table-column",{attrs:{width:"50px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text"},on:{click:function(i){return t.deldrug(e.row)}}},[t._v("删除")])]}}])}),t._v(" "),i("el-table-column",{attrs:{property:"name",label:"药品名",width:"150"}}),t._v(" "),i("el-table-column",{attrs:{property:"format",label:"规格",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{property:"price",label:"单价"}}),t._v(" "),i("el-table-column",{attrs:{label:"数量",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right",min:1,max:100,size:"mini"},on:{change:function(i){return t.changenum(e.row)}},model:{value:e.row.num,callback:function(i){t.$set(e.row,"num",i)},expression:"scope.row.num"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"剂型",width:"130px",prop:"dosage.name"}}),t._v(" "),i("el-table-column",{attrs:{label:"使用建议",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{placeholder:"用法"},model:{value:e.row.medicalAdvice,callback:function(i){t.$set(e.row,"medicalAdvice",i)},expression:"scope.row.medicalAdvice"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"频次",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:""},model:{value:e.row.frequency,callback:function(i){t.$set(e.row,"frequency",i)},expression:"scope.row.frequency"}},t._l([{key:1,label:"一天一次"},{key:2,label:"一天三次"}],(function(t){return i("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),1)]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"天数",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{placeholder:""},model:{value:e.row.days,callback:function(i){t.$set(e.row,"days",i)},expression:"scope.row.days"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"用量",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-input",{attrs:{placeholder:""},model:{value:e.row.usageNum,callback:function(i){t.$set(e.row,"usageNum",i)},expression:"scope.row.usageNum"}})]}}])}),t._v(" "),i("el-table-column",{attrs:{label:"单位",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-select",{staticStyle:{width:"120px"},attrs:{placeholder:""},model:{value:e.row.usageNumUnit,callback:function(i){t.$set(e.row,"usageNumUnit",i)},expression:"scope.row.usageNumUnit"}},t._l([{key:1,label:"片"},{key:2,label:"支"},{key:3,label:"瓶"},{key:2,label:"克"}],(function(t){return i("el-option",{key:t.key,attrs:{label:t.label,value:t.key}})})),1)]}}])})],1)],1)],1)],1)],1)},a=[],l=(i("a450"),i("4057"),i("aa18"),i("982e"),i("e186"),i("c6da")),r=(i("1bc7"),i("efa4")),o=i("1e0f"),s=i("333d"),u=i("ed08"),c={components:{Pagination:s["a"]},data:function(){return{page:{pageNum:1,pageSize:10},oneprescription:{name:"",druglist:[],amount:0,status:0},itemdrugList:[],drugList:[],searchdrug:"",choices:[],dialogVisible:!1,alldrugList:[],nondrugList:[],edit:0,model:{},total2:0,loading:!1,isaside:!1,asidewidth:"100%",total:0,listQuery:{id:"",status:1,name:"",scope:0,ownId:this.$store.getters.id,aim:"",code:"",type:1,pageSize:20,pageNum:1,isAdmin:"0"},modelList:[],queryModel:{name:"",range:"",type:""}}},created:function(){this.getModelList()},methods:{addDrug:function(){this.dialogVisible=!1,this.itemdrugList=this.oneprescription.druglist,this.itemdrugList.forEach((function(t){t.totalprice=Math.floor(t.price*t.num*100)/100}))},getdrugList:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){var i,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i={},i.pageSize=this.page.pageSize,i.pageNum=this.page.pageNum,0!==e&&(i.typeId=e),i.name=this.searchdrug,t.next=7,Object(o["e"])(i);case 7:n=t.sent,this.drugList=n.data.list,this.total2=n.data.total;case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),deldrug:function(t){var e=this;this.oneprescription.druglist=this.oneprescription.druglist.filter((function(e){return e.id!==t.id})),this.oneprescription.amount=0,this.oneprescription.druglist.forEach((function(t){e.oneprescription.amount+=t.price})),this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100},choosedrug:function(t){var e=1;this.oneprescription.druglist.forEach((function(i){i.id===t.id&&(i.num+=1,e=0)})),e&&(this.oneprescription.amount+=t.price,this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100,this.oneprescription.druglist.push(t),this.oneprescription.druglist.forEach((function(t){void 0===t.num&&(t.num=1)})))},deleteModel:function(t){var e=this;this.$confirm("确认删除当前模板?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(r["b"])(t.id).then((function(t){e.getModelList(),e.$notify({title:"成功",message:t.message,type:"success",duration:2e3})}))}))},createModel:function(){var t=this,e=Object(u["c"])(this.model);e.status=1,e.ownId=this.$store.getters.id,e.dmsMedicineModelItemList=Object(u["c"])(this.itemdrugList),e.type=1,Object(r["a"])(e).then((function(e){t.getModelList(),t.$notify({title:"成功",message:e.message,type:"success",duration:2e3})})),this.showaside()},updateModel:function(){var t=this,e=Object(u["c"])(this.model);e.nonDrugIdList=Object(u["c"])(this.choices),e.createTime="",e.ownId=this.$store.getters.id,Object(r["d"])(e).then((function(e){t.$notify({title:"成功",message:"修改成功",type:"success",duration:2e3}),t.getModelList()})),this.showaside()},confirmItem:function(){var t=this;this.nondrugList=this.alldrugList.filter((function(e){if(t.choices.includes(e.id))return!0})),this.dialogVisible=!this.dialogVisible},addItem:function(){this.dialogVisible=!0,this.getdrugList()},getAllNondrug:function(t){function e(){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(){var t=this;getAllNondrug().then((function(e){t.alldrugList=e.data,t.alldrugList.forEach((function(t){t.label=t.name,t.key=t.id}))}))})),getModelList:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:Object(r["c"])(this.listQuery).then((function(t){e.modelList=t.data.list,e.modelList.forEach((function(t){t.dmsMedicineModelItemList.forEach((function(t){Object(o["f"])(t.id).then((function(e){t.name=e.data.name,t.format=e.data.format,t.price=e.data.price,t.totalprice=t.price*t.num,t.mnemonicCode=e.data.mnemonicCode}))})),t.createTime=Object(u["f"])(t.createTime)})),e.total=t.data.total}));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),searchModel:function(){this.loading=!0,this.getModelList(),this.loading=!1},showaside:function(t){"100%"===this.asidewidth?this.asidewidth="0%":this.asidewidth="100%",this.isaside=!this.isaside,"edit"===t?this.edit=1:"add"===t?(this.choices=[],this.nondrugList=[],this.itemdrugList=[],this.model={},this.edit=0):this.edit=0},editModel:function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.model=Object(u["c"])(e),this.itemdrugList=this.model.dmsMedicineModelItemList,this.showaside("edit");case 3:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},d=c,p=(i("a02d"),i("cba8")),m=Object(p["a"])(d,n,a,!1,null,null,null);e["default"]=m.exports},9821:function(t,e,i){},a02d:function(t,e,i){"use strict";i("9821")},efa4:function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return l})),i.d(e,"c",(function(){return r})),i.d(e,"d",(function(){return o}));var n=i("b775");function a(t){return Object(n["a"])({url:"/drugModel/createModel",method:"post",data:t})}function l(t){return Object(n["a"])({url:"/drugModel/deleteModel",method:"post",params:{ids:t}})}function r(t){return Object(n["a"])({url:"/drugModel/listModel",method:"get",params:t})}function o(t){return Object(n["a"])({url:"/drugModel/updateModel",method:"post",params:{modelId:t.id},data:t})}}}]);