(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32f7413e"],{"09f4":function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),Math.easeInOutQuad=function(e,t,n,a){return e/=a/2,e<1?n/2*e*e+t:(e--,-n/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function l(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(e,t,n){var r=l(),o=e-r,s=20,c=0;t="undefined"===typeof t?500:t;var u=function e(){c+=s;var l=Math.easeInOutQuad(c,r,o,t);i(l),c<t?a(e):n&&"function"===typeof n&&n()};u()}},"1e0f":function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return r})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u}));var a=n("b775");function i(e){return Object(a["a"])({url:"/drug/selectDrug",method:"post",params:e})}function l(){return Object(a["a"])({url:"/drug/selectAllDrug",method:"get"})}function r(){return Object(a["a"])({url:"/drug/selectAllDosage",method:"get"})}function o(e){return Object(a["a"])({url:"/drug/updateDrug/"+e.id,method:"post",data:e})}function s(e){return Object(a["a"])({url:"/drug/deleteDrug",method:"post",params:{ids:e}})}function c(e){return Object(a["a"])({url:"/drug/createDrug",method:"post",data:e})}function u(e){return Object(a["a"])({url:"/drug/selectById",method:"get",params:{id:e}})}},2744:function(e,t,n){},"310b":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"药品编码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.code,callback:function(t){e.$set(e.listQuery,"code",t)},expression:"listQuery.code"}}),e._v(" "),n("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"药品名称"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleFilter(t)}},model:{value:e.listQuery.name,callback:function(t){e.$set(e.listQuery,"name",t)},expression:"listQuery.name"}}),e._v(" "),n("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"药品分类",clearable:"",filterable:""},model:{value:e.listQuery.typeID,callback:function(t){e.$set(e.listQuery,"typeID",t)},expression:"listQuery.typeID"}},e._l([{key:"101",label:"西药"},{key:"102",label:"中成药"},{key:"103",label:"中草药"}],(function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("\n      搜索药品\n    ")]),e._v(" "),n("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"el-icon-edit"},on:{click:e.handleAdd}},[e._v("\n      新增药品\n    ")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("\n      导出药品\n    ")]),e._v(" "),n("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"danger",icon:"el-icon-download"},on:{click:e.handleSomeDelete}},[e._v("\n      批量删除\n    ")])],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.drugList,border:""},on:{"selection-change":e.changedep}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{prop:"code",align:"center",fixed:"",label:"药品编码",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.code)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"",label:"药品名称",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.name)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品规格",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.format)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品单价",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.price)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"包装单位",width:"70"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.unit)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"生产厂家",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.manufacturer)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品剂型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.dosage.name)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品单价"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.price)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[101===t.row.typeId?n("span",[e._v("西药")]):e._e(),e._v(" "),102===t.row.typeId?n("span",[e._v("中成药")]):e._e(),e._v(" "),103===t.row.typeId?n("span",[e._v("中草药")]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"助记码",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.mnemonicCode)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.stock)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",label:"通用名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n        "+e._s(t.row.genericName)+"\n      ")]}}])}),e._v(" "),n("el-table-column",{attrs:{align:"center",fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(n){return e.handleEdit(t.row)}}},[e._v("修改")]),e._v(" "),n("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(n){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{visible:e.dialogVisible,width:"650px",title:"edit"===e.dialogType?"修改药品信息":"新增药品"},on:{"update:visible":function(t){e.dialogVisible=t},close:e.getDeplist}},[n("el-form",{ref:"depart",attrs:{model:e.drug,"label-width":"80px",inline:"","label-position":"left",rules:e.rules}},[n("el-form-item",{attrs:{label:"药品编号"}},[n("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"编号"},model:{value:e.drug.code,callback:function(t){e.$set(e.drug,"code",t)},expression:"drug.code"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"药品名称"}},[n("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"药品名称"},model:{value:e.drug.name,callback:function(t){e.$set(e.drug,"name",t)},expression:"drug.name"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"生产厂家"}},[n("el-input",{staticStyle:{width:"350px"},attrs:{placeholder:"生产厂家"},model:{value:e.drug.manufacturer,callback:function(t){e.$set(e.drug,"manufacturer",t)},expression:"drug.manufacturer"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"药品类型"}},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"180px"},attrs:{placeholder:"药品类型",clearable:"",filterable:""},model:{value:e.drug.typeId,callback:function(t){e.$set(e.drug,"typeId",t)},expression:"drug.typeId"}},e._l([{key:101,label:"西药"},{key:102,label:"中成药"},{key:103,label:"中草药"}],(function(e){return n("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"药品规格"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"药品规格"},model:{value:e.drug.format,callback:function(t){e.$set(e.drug,"format",t)},expression:"drug.format"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"药品单价"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"药品单价"},model:{value:e.drug.price,callback:function(t){e.$set(e.drug,"price",t)},expression:"drug.price"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"包装单位"}},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"包装单位",clearable:"",filterable:""},model:{value:e.drug.unit,callback:function(t){e.$set(e.drug,"unit",t)},expression:"drug.unit"}},e._l(["支","瓶","袋","盒","克"],(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"助记码"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"助记码"},model:{value:e.drug.mnemonicCode,callback:function(t){e.$set(e.drug,"mnemonicCode",t)},expression:"drug.mnemonicCode"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"药品剂型"}},[n("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"药品剂型",clearable:"",filterable:""},model:{value:e.drug.dosage.id,callback:function(t){e.$set(e.drug.dosage,"id",t)},expression:"drug.dosage.id"}},e._l(e.allDosage,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"通用名"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"通用名"},model:{value:e.drug.genericName,callback:function(t){e.$set(e.drug,"genericName",t)},expression:"drug.genericName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"库存"}},[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"库存"},model:{value:e.drug.stock,callback:function(t){e.$set(e.drug,"stock",t)},expression:"drug.stock"}})],1)],1),e._v(" "),n("div",{staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{type:"danger"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.confirmDep("depart")}}},[e._v("确认")])],1)],1),e._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.pageNum,limit:e.listQuery.pageSize},on:{"update:page":function(t){return e.$set(e.listQuery,"pageNum",t)},"update:limit":function(t){return e.$set(e.listQuery,"pageSize",t)},pagination:e.getdrugList}})],1)},i=[],l=(n("e186"),n("c6da")),r=(n("1bc7"),n("0c84"),n("6266"),n("ed08")),o=n("1e0f"),s=n("333d"),c=n("51a4"),u={id:"",code:"",name:"",format:"",price:"",unit:"",manufacturer:"",dosage:{id:""},dosageId:"",typeID:"",mnemonicCode:"",stock:"",genericName:""},d={components:{Pagination:s["a"]},data:function(){return{drug:Object.assign({},u),drugList:[],allDosage:[],dialogVisible:!1,dialogType:"new",checkStrictly:!1,defaultProps:{children:"children",label:"title"},deptype:[1,2,3,4],total:0,listLoading:!0,allCatId:[],allDep:[],allType:[],listQuery:{id:"",code:"",name:"",format:"",price:"",unit:"",manufacturer:"",dosage:{},typeId:"",mnemonicCode:"",stock:"",genericName:"",pageNum:1,pageSize:20},downloadLoading:!1,rules:{},deplistref:[]}},computed:{},created:function(){c["Promise"].all([this.getDosage(),this.getdrugList()])},methods:{getDosage:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["c"])();case 2:t=e.sent,this.allDosage=t.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getdrugList:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.listLoading=!0,e.next=3,Object(o["e"])(this.listQuery);case 3:t=e.sent,this.drugList=t.data.list,this.total=t.data.total,this.listLoading=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleFilter:function(){this.listQuery.page=1,this.listQuery.typeId=this.listQuery.typeID,this.getdrugList()},handleAdd:function(){var e=this;this.resetTemp(),this.dialogType="new",this.dialogVisible=!0,this.checkStrictly=!0,this.$nextTick((function(){e.$refs["depart"].clearValidate()}))},handleEdit:function(e){var t=this;this.resetTemp(),this.drug=Object(r["c"])(e),this.drug.typeID=Object(r["c"])(e.typeId),console.log(this.drug),this.dialogType="edit",this.dialogVisible=!0,this.checkStrictly=!0,this.$nextTick((function(){t.$refs["depart"].clearValidate()}))},resetTemp:function(){this.drug=Object.assign({},u)},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return"timestamp"===e?parseTime(t[e]):t[e]}))}))},changedep:function(e){this.deplistref=e},handleSomeDelete:function(){var e=this;this.$confirm("确认删除选中药品?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){for(var t="",n=0;n<e.deplistref.length;n++)n!==e.deplistref.length-1?t=t+e.deplistref[n].id+",":t+=e.deplistref[n].id;Object(o["b"])(t).then((function(t){e.$notify({title:"成功",message:t.message,type:"success",duration:2e3}),e.getdrugList()}))}))},handleDelete:function(e){var t=this;this.$confirm("确认删除当前药品?","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["b"])(e.id).then((function(e){t.$notify({title:"成功",message:"已删除该药品",type:"success",duration:2e3}),t.getdrugList()}))}))},handleDownload:function(){var e=this;Object(o["d"])().then((function(t){var a=t.data;e.downloadLoading=!0,Promise.all([n.e("chunk-e197b99c"),n.e("chunk-67fec494"),n.e("chunk-581b2547")]).then(n.bind(null,"4bf8d")).then((function(t){var n=["索引","药品编码","药品名称","药品规格","药品单价","包装单位","生产厂家","药品类型","拼音助记码","通用名","库存"],i=["id","code","name","format","price","unit","manufacturer","typeId","mnemonicCode","genericName","stock"],l=e.formatJson(i,a);t.export_json_to_excel({header:n,data:l,filename:"药品清单"}),e.downloadLoading=!1}))}))},confirmDep:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.$refs[t].validate((function(e){if(n.drug.dosageID=n.drug.dosage.id,n.drug.dosageId=n.drug.dosage.id,n.drug.typeID=n.drug.typeId,e){var t="edit"===n.dialogType;n.listLoading=!0,t?(Object(o["g"])(n.drug).then((function(e){n.getdrugList(),n.$notify({title:"成功",message:"已修改该药品",type:"success",duration:2e3})})),n.dialogVisible=!1):Object(o["a"])(n.drug).then((function(e){n.getdrugList(),n.$notify({title:"成功",message:e.message,type:"success",duration:2e3}),n.dialogVisible=!1}))}}));case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}},p=d,f=(n("54c7"),n("cba8")),m=Object(f["a"])(p,a,i,!1,null,"2b23300b",null);t["default"]=m.exports},"54c7":function(e,t,n){"use strict";n("2744")}}]);