(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-78cbf022"],{"09f4":function(t,e,a){"use strict";a.d(e,"a",(function(){return r})),Math.easeInOutQuad=function(t,e,a,i){return t/=i/2,t<1?a/2*t*t+e:(t--,-a/2*(t*(t-2)-1)+e)};var i=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}();function n(t){document.documentElement.scrollTop=t,document.body.parentNode.scrollTop=t,document.body.scrollTop=t}function s(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function r(t,e,a){var r=s(),o=t-r,l=20,c=0;e="undefined"===typeof e?500:e;var u=function t(){c+=l;var s=Math.easeInOutQuad(c,r,o,e);n(s),c<e?i(t):a&&"function"===typeof a&&a()};u()}},"1e0f":function(t,e,a){"use strict";a.d(e,"e",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"g",(function(){return o})),a.d(e,"b",(function(){return l})),a.d(e,"a",(function(){return c})),a.d(e,"f",(function(){return u}));var i=a("b775");function n(t){return Object(i["a"])({url:"/drug/selectDrug",method:"post",params:t})}function s(){return Object(i["a"])({url:"/drug/selectAllDrug",method:"get"})}function r(){return Object(i["a"])({url:"/drug/selectAllDosage",method:"get"})}function o(t){return Object(i["a"])({url:"/drug/updateDrug/"+t.id,method:"post",data:t})}function l(t){return Object(i["a"])({url:"/drug/deleteDrug",method:"post",params:{ids:t}})}function c(t){return Object(i["a"])({url:"/drug/createDrug",method:"post",data:t})}function u(t){return Object(i["a"])({url:"/drug/selectById",method:"get",params:{id:t}})}},"2f8d":function(t,e,a){"use strict";a("4a84")},"4a84":function(t,e,a){},"7bc7":function(t,e,a){"use strict";a("fe6e")},bf23:function(t,e,a){"use strict";a.d(e,"a",(function(){return n})),a.d(e,"d",(function(){return s})),a.d(e,"c",(function(){return r})),a.d(e,"b",(function(){return o}));var i=a("b775");function n(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/apply",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/listByReg",method:"post",params:{registrationId:t}})}function r(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/listByIds",method:"post",params:{ids:t}})}function o(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/invalid",method:"post",params:{ids:t}})}},e4c3:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"div1"},[a("aside",[a("el-button",{staticStyle:{color:"black"},attrs:{disabled:""}},[t._v("门诊医技工作台")]),t._v(" "),a("el-input",{staticClass:"filter-item input1",staticStyle:{width:"180px","margin-left":"50px"},attrs:{placeholder:"病历号/姓名"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}),t._v(" "),a("el-button",[a("svg-icon",{attrs:{"icon-class":"search"}})],1)],1),t._v(" "),a("el-table",{staticStyle:{"margin-left":"10px"},attrs:{border:"",stripe:"","highlight-current-row":"",data:t.MechList.filter((function(e){return!t.search||e.patientName.toLowerCase().includes(t.search.toLowerCase())}))}},[a("el-table-column",{attrs:{align:"center",label:"病历号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.registrationId)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"姓名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.patientName)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"年龄"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.patientAgeStr)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"性别"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.patientGender?a("span",[t._v("男")]):t._e(),t._v(" "),1===e.row.patientGender?a("span",[t._v("女")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"开立项目"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.itemName)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"检查部位"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.checkParts)+"\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{directives:[{name:"show",rawName:"v-show",value:2===e.row.status,expression:"scope.row.status===2"}],attrs:{type:"info"}},[t._v("未登记")]),t._v(" "),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:3===e.row.status,expression:"scope.row.status===3"}],attrs:{type:"primary"}},[t._v("已登记")]),t._v(" "),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:4===e.row.status,expression:"scope.row.status===4"}],attrs:{type:"success"}},[t._v("已完成")]),t._v(" "),a("el-tag",{directives:[{name:"show",rawName:"v-show",value:1===e.row.status,expression:"scope.row.status===1"}],attrs:{type:"warning"}},[t._v("未缴费")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[3===e.row.status?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.upload(e.row)}}},[t._v("上传结果")]):t._e(),t._v(" "),4===e.row.status?a("el-button",{attrs:{size:"small",disabled:""}},[t._v("已完成")]):t._e(),t._v(" "),1===e.row.status?a("el-button",{attrs:{size:"small",disabled:""}},[t._v("未缴费")]):t._e(),t._v(" "),2===e.row.status?a("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return t.register(e.row)}}},[t._v("登记")]):t._e(),t._v(" "),2===e.row.status?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return t.addExtra(e.row)}}},[t._v("补录")]):t._e()]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"药材补录",visible:t.dialogTableVisible,width:"1500px",top:"10px"},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-container",[a("el-aside",{staticStyle:{padding:"0 0 0 0",margin:"0 0 0 0"},attrs:{width:"30%"}},[a("el-tag",{staticStyle:{width:"100%",height:"30px"},attrs:{type:"primary"}},[t._v("药品目录\n          "),a("el-button",{staticStyle:{width:"20px",float:"right"},attrs:{type:"primary",size:"mini"}},[a("svg-icon",{staticStyle:{"margin-left":"-6px"},attrs:{"icon-class":"search"}})],1),t._v(" "),a("el-input",{staticStyle:{width:"60%",float:"right"},attrs:{size:"mini",placeholder:"药品名称"},on:{change:function(e){return t.getdrugList(0)}},model:{value:t.searchdrug,callback:function(e){t.searchdrug=e},expression:"searchdrug"}})],1),t._v(" "),a("el-table",{attrs:{data:t.drugList,height:"500px"},on:{"row-click":t.choosedrug}},[a("el-table-column",{attrs:{label:"药品名",prop:"name"}}),t._v(" "),a("el-table-column",{attrs:{label:"价格(元)",prop:"price",width:"100px"}})],1),t._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],staticStyle:{"margin-top":"0px"},attrs:{layout:"prev, pager, next","auto-scroll":"false","page-sizes":"[]",total:t.total,page:t.page.pageNum,limit:t.page.pageSize},on:{"update:page":function(e){return t.$set(t.page,"pageNum",e)},"update:limit":function(e){return t.$set(t.page,"pageSize",e)},pagination:function(e){return t.getdrugList(0)}}}),t._v(" "),a("div")],1),t._v(" "),a("el-main",[a("el-form",{attrs:{"label-width":"100px",model:t.extraname,inline:""}},[a("el-form-item",{attrs:{label:"补录处方名"}},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:""},model:{value:t.extraname.name,callback:function(e){t.$set(t.extraname,"name",e)},expression:"extraname.name"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"补录处方类型"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"130px"},attrs:{placeholder:"选择类型",clearable:""},on:{change:t.changeextratype},model:{value:t.extraname.type,callback:function(e){t.$set(t.extraname,"type",e)},expression:"extraname.type"}},t._l([{key:1,value:"成药处方"},{key:2,value:"草药处方"}],(function(t){return a("el-option",{key:t.key,attrs:{label:t.value,value:t.key}})})),1)],1),t._v(" "),a("el-form-item",[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.comfirmExtra}},[t._v("补录处方开立")])],1)],1),t._v(" "),a("el-tag",{attrs:{type:"primary"}},[t._v("项目金额总计:")]),t._v(" "),a("el-tag",{attrs:{type:"warning"}},[t._v(t._s(t.oneprescription.amount)+"元")]),t._v(" "),a("el-table",{attrs:{height:"500px",data:t.oneprescription.druglist,"cell-style":"text-align:center","header-cell-style":"text-align:center"}},[a("el-table-column",{attrs:{width:"50px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.deldrug(e.row)}}},[t._v("删除")])]}}])}),t._v(" "),a("el-table-column",{attrs:{property:"name",label:"药品名",width:"150"}}),t._v(" "),a("el-table-column",{attrs:{property:"format",label:"规格",width:"200"}}),t._v(" "),a("el-table-column",{attrs:{property:"price",label:"单价"}}),t._v(" "),a("el-table-column",{attrs:{label:"数量",width:"130px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input-number",{staticStyle:{width:"100px"},attrs:{"controls-position":"right",min:1,max:100,size:"mini"},on:{change:function(a){return t.changenum(e.row)}},model:{value:e.row.num,callback:function(a){t.$set(e.row,"num",a)},expression:"scope.row.num"}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"剂型",width:"130px",prop:"dosage.name"}}),t._v(" "),a("el-table-column",{attrs:{label:"使用建议",width:"130"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-input",{attrs:{placeholder:"用法"},model:{value:e.row.medicalAdvice,callback:function(a){t.$set(e.row,"medicalAdvice",a)},expression:"scope.row.medicalAdvice"}})]}}])})],1)],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"结果",visible:t.uploadvisible,patient:t.patient,width:"400px"},on:{"update:visible":function(e){t.uploadvisible=e}}},[a("Upload",{ref:"upload",attrs:{uploadpatient:t.uploadpatient},on:{reflect:t.reflect}})],1)],1)},n=[],s=(a("e186"),a("c6da")),r=(a("1bc7"),a("a450"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-container"},[a("el-form",[a("el-form-item",{attrs:{label:"检查结果"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{type:"textarea",autosize:{minRows:2,maxRows:3},placeholder:""},model:{value:t.checkResult,callback:function(e){t.checkResult=e},expression:"checkResult"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"",align:"center"}},[a("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n      ")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.uploadResult}},[t._v("确 定")])],1)],1),t._v(" "),a("el-dialog",{attrs:{"append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-upload",{staticClass:"editor-slide-upload",attrs:{action:t.dataObj.host,data:t.dataObj,multiple:!0,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)}),o=[],l=(a("32ea"),a("b775"));function c(t){return Object(l["a"])({url:"/aliyun/oss/policy",method:"get",data:t})}function u(t){return Object(l["a"])({url:"/DmsMechanicItemRecord/uploadResult",method:"post",params:t})}var d={props:["uploadpatient"],name:"Upload",data:function(){return{checkResult:"",color:"#1890ff",dialogVisible:!1,listObj:{},arr:[],fileList:[],dataObj:{policy:"",signature:"",key:"",ossaccessKeyId:"",dir:"",host:""}}},watch:{uploadpatient:function(t,e){this.uploadpatient=t}},created:function(){var t=this;c().then((function(e){t.dataObj=e.data}))},methods:{uploadResult:function(){var t=this,e={};e.id=this.uploadpatient,e.executeStaffId=this.$store.getters.id,e.checkResult=this.checkResult,e.resultImgUrlList="",this.arr.forEach((function(t){e.resultImgUrlList+=t.url+","})),e.resultImgUrlList=e.resultImgUrlList.substr(0,e.resultImgUrlList.length-1),u(e).then((function(e){t.$notify({title:"成功",message:e.message,type:"success",duration:2e3}),console.log(8921),t.$emit("reflect"),console.log(666312)}))},checkAllSuccess:function(){var t=this;return Object.keys(this.listObj).every((function(e){return t.listObj[e].hasSuccess}))},handleSubmit:function(){var t=this,e=Object.keys(this.listObj).map((function(e){return t.listObj[e]}));this.checkAllSuccess()?(this.arr=e,this.dialogVisible=!1,this.reflect()):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var a=e.uid,i=Object.keys(this.listObj),n=0,s=i.length;n<s;n++)if(this.listObj[i[n]].uid===a)return this.listObj[i[n]].url=this.dataObj.host+"/"+this.dataObj.dir+"/"+e.name,void(this.listObj[i[n]].hasSuccess=!0);this.$notify({title:"成功",message:"上传成功222",type:"success",duration:2e3})},handleRemove:function(t){for(var e=t.uid,a=Object.keys(this.listObj),i=0,n=a.length;i<n;i++)if(this.listObj[a[i]].uid===e)return void delete this.listObj[a[i]]},beforeUpload:function(t){var e=this,a=this,i=t.uid;return this.listObj[i]={},new Promise((function(n,s){c().then((function(s){a.dataObj.policy=s.data.policy,a.dataObj.signature=s.data.signature,a.dataObj.ossaccessKeyId=s.data.accessKeyId,a.dataObj.key=s.data.dir+"/${filename}",a.dataObj.dir=s.data.dir,a.dataObj.host=s.data.host,a.listObj[i]={hasSuccess:!1,uid:t.uid,width:e.width,height:e.height},n(!0)})).catch((function(t){console.log(t),s(!1)}))}))}}},p=d,m=(a("2f8d"),a("cba8")),f=Object(m["a"])(p,r,o,!1,null,"a1ee0176",null),h=f.exports;function g(t){return Object(l["a"])({url:"/DmsMechanicItemRecord/listByDept",method:"post",params:{deptId:t}})}function b(t){return Object(l["a"])({url:"/DmsMechanicItemRecord/log",method:"post",params:{itemRecordId:t.id,logStaffId:t.logStaffId}})}var v=a("1e0f"),y=a("333d"),w=a("bf23"),_={components:{Upload:h,Pagination:y["a"]},data:function(){return{uploadpatient:"",extraname:{name:"",type:1},page:{pageNum:1,pageSize:10},oneprescription:{name:"",druglist:[],amount:0,status:0},patient:{},uploadvisible:!1,MechList:[],drugList:[],searchdrug:"",dialogTableVisible:!1,search:"",isaside:!0,activeName:"first",activeName2:"first",data2:[{date:"0001",name:"王小虎1",address:"验血",status:0},{date:"0002",name:"王小虎2",address:"验血",status:0},{date:"0003",name:"王小虎3",address:"验血",status:0},{date:"0004",name:"王小虎4",address:"验血",status:3},{date:"0004",name:"王小虎4",address:"验血",status:2},{date:"0004",name:"王小虎4",address:"验血",status:1},{date:"0004",name:"王小虎4",address:"验血",status:1}]}},created:function(){this.getMechlist()},methods:{reflect:function(){this.$notify({title:"成功",message:"上传成功",type:"success",duration:2e3}),this.uploadvisible=!1,this.getMechlist()},comfirmExtra:function(){var t=this,e={};e=this.oneprescription,e.registrationId=this.patient.registrationId,e.name=this.extraname.name,e.createStaffId=this.$store.getters.id,e.status=1,e.amount=this.oneprescription.amount,e.dmsMedicineItemRecordList=e.druglist,e.dmsMedicineItemRecordList.forEach((function(t){t.drugId=t.id})),Object(w["a"])(e).then((function(e){t.$notify({title:"成功",message:e.message,type:"success",duration:2e3})})),this.dialogTableVisible=!1},deldrug:function(t){var e=this;this.oneprescription.druglist=this.oneprescription.druglist.filter((function(e){return e.id!==t.id})),this.oneprescription.amount=0,this.oneprescription.druglist.forEach((function(t){e.oneprescription.amount+=t.price})),this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100},choosedrug:function(t){var e=1;this.oneprescription.druglist.forEach((function(a){a.id===t.id&&(a.num+=1,e=0)})),e&&(this.oneprescription.amount+=t.price,this.oneprescription.amount=Math.floor(100*(this.oneprescription.amount+.5))/100,this.oneprescription.druglist.push(t),this.oneprescription.druglist.forEach((function(t){void 0===t.num&&(t.num=1)})))},changeextratype:function(t){1===t?this.getdrugList(101):this.getdrugList(103)},getdrugList:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={},a.pageSize=this.page.pageSize,a.pageNum=this.page.pageNum,0!==e&&(a.typeId=e),a.name=this.searchdrug,t.next=7,Object(v["e"])(a);case 7:i=t.sent,this.drugList=i.data.list,this.total=i.data.total;case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),upload:function(t){this.uploadpatient=t.itemRecordId,this.uploadvisible=!0},getMechlist:function(){var t=this;g("128").then((function(e){t.MechList=e.data}))},addExtra:function(t){this.patient=t,this.dialogTableVisible=!0,this.getdrugList(101)},showaside:function(){this.isaside=!this.isaside},register:function(t){var e=this;this.$confirm("确定为 "+t.patientName+" 登记项目 "+t.itemName+" 吗?","项目登记",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var a={};a.id=t.itemRecordId,a.logStaffId=e.$store.getters.id,b(a).then((function(t){e.$notify({title:"成功",message:t.message,type:"success",duration:2e3}),e.getMechlist()}))}))}}},x=_,k=(a("7bc7"),Object(m["a"])(x,i,n,!1,null,null,null));e["default"]=k.exports},fe6e:function(t,e,a){}}]);