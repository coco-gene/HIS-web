(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c22bc97"],{"0a91":function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return r}));var i=n("b775");function a(t){return Object(i["a"])({url:"/drugStore/listPatient",method:"post",params:t})}function s(t,e){return Object(i["a"])({url:"/drugStore/releaseDrug",method:"post",params:{prescriptionId:t,type:e}})}function r(t){return Object(i["a"])({url:"/drugStore/refundDrug",method:"post",data:t})}},"0fcc":function(t,e,n){},"37e8":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"div1"},[n("el-container",[n("transition",{attrs:{name:"el-zoom-in-left"}},[n("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.isaside,expression:"isaside"}],staticStyle:{padding:"0 0 0 0"},attrs:{width:"350px"}},[n("div",[n("el-card",{staticStyle:{width:"350px"}},[n("span",{staticStyle:{"font-family":"'微软雅黑'","font-size":"13px"}},[t._v("查询患者名:")]),t._v(" "),n("el-input",{staticClass:"filter-item input1",staticStyle:{width:"180px"},attrs:{placeholder:"患者名"},model:{value:t.searchpatient,callback:function(e){t.searchpatient=e},expression:"searchpatient"}}),t._v(" "),n("el-button",{staticStyle:{width:"20px"},attrs:{type:"primary"}},[n("svg-icon",{staticStyle:{"margin-left":"-6px"},attrs:{"icon-class":"search"}})],1),t._v(" "),n("el-tabs",{staticStyle:{"margin-top":"15px"},attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[n("el-tab-pane",{attrs:{label:"未发药",name:"first"}},[n("el-tag",{staticStyle:{width:"100%"}},[t._v("未发药")]),t._v(" "),n("el-table",{attrs:{stripe:"",data:t.undoPatientList.filter((function(e){return!t.searchpatient||e.patientName.toLowerCase().includes(t.searchpatient.toLowerCase())||e.medicalRecordNo.toLowerCase().includes(t.searchpatient.toLowerCase())})),height:"480","highlight-current-row":""},on:{"row-click":t.handleGive}},[n("el-table-column",{attrs:{align:"center",label:"病历号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.medicalRecordNo)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"名字"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.patientName)+"\n        ")]}}])})],1)],1),t._v(" "),n("el-tab-pane",{attrs:{label:"已发药",name:"second"}},[n("el-tag",{staticStyle:{width:"100%"},attrs:{type:"warning"}},[t._v("已发药")]),t._v(" "),n("el-table",{attrs:{stripe:"",data:t.donePatientList.filter((function(e){return!t.searchpatient||e.patientName.toLowerCase().includes(t.searchpatient.toLowerCase())||e.medicalRecordNo.toLowerCase().includes(t.searchpatient.toLowerCase())})),height:"460","highlight-current-row":""},on:{"row-click":t.handleGiven}},[n("el-table-column",{attrs:{align:"center",label:"病历号"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.medicalRecordNo)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"名字"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.patientName)+"\n        ")]}}])})],1)],1)],1)],1)],1)])],1),t._v(" "),n("el-main",{directives:[{name:"show",rawName:"v-show",value:!t.isGiven,expression:"!isGiven"}],staticStyle:{padding:"0 0 0 0"}},[n("aside",[n("el-button",{staticStyle:{width:"40px","padding-left":"13px"},attrs:{size:"mini",type:"primary"},on:{click:t.showaside}},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.isaside,expression:"isaside"}],staticClass:"el-icon-arrow-left"}),n("i",{directives:[{name:"show",rawName:"v-show",value:!t.isaside,expression:"!isaside"}],staticClass:"el-icon-arrow-right"})]),t._v(" "),n("span",{staticStyle:{"margin-left":"15px","font-size":"14px","font-family":"'微软雅黑'"}},[t._v("当前患者：")]),t._v(" "),n("el-tag",{staticClass:"painfo",staticStyle:{width:"15%","font-family":"'微软雅黑'"},attrs:{color:"white"}},[t._v("姓名: "),n("span",{staticStyle:{color:"black"}},[t._v(t._s(t.patient.patientName))])]),t._v(" "),n("el-tag",{staticClass:"painfo",staticStyle:{width:"25%","font-family":"'微软雅黑'"},attrs:{color:"white"}},[t._v("就诊号: "),n("span",{staticStyle:{color:"black"}},[t._v(t._s(t.patient.medicalRecordNo))])]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"success",plain:""},on:{click:t.sendDrug}},[n("svg-icon",{attrs:{"icon-class":"skill"}}),t._v("发药")],1)],1),t._v(" "),n("el-table",{staticStyle:{"margin-left":"10px"},attrs:{height:"600px",border:"",stripe:"","highlight-current-row":"",data:t.druglist,"span-method":t.objectSpanMethod},on:{"selection-change":t.changedep}},[n("el-table-column",{attrs:{type:"selection",width:"55"},on:{"selection-change":t.changedep}}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"处方号",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.id)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"处方名",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.cname)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品名"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.drugName)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.num)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"单价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.price)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"开立医生"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.doctorname)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"频次"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.frequency)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"使用建议"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.medicalAdvice)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center"}},[n("el-tag",{attrs:{type:"primary"}},[t._v("未取药")])],1)],1)],1),t._v(" "),n("el-main",{directives:[{name:"show",rawName:"v-show",value:t.isGiven,expression:"isGiven"}],staticStyle:{padding:"0 0 0 0"}},[n("aside",[n("el-button",{staticStyle:{width:"40px","padding-left":"13px"},attrs:{size:"mini",type:"primary"},on:{click:t.showaside}},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.isaside,expression:"isaside"}],staticClass:"el-icon-arrow-left"}),n("i",{directives:[{name:"show",rawName:"v-show",value:!t.isaside,expression:"!isaside"}],staticClass:"el-icon-arrow-right"})]),t._v(" "),n("span",{staticStyle:{"margin-left":"15px","font-size":"14px","font-family":"'微软雅黑'"}},[t._v("当前患者：")]),t._v(" "),n("el-tag",{staticClass:"painfo",staticStyle:{width:"15%","font-family":"'微软雅黑'"},attrs:{color:"white"}},[t._v("姓名: "),n("span",{staticStyle:{color:"black"}},[t._v(t._s(t.patient.patientName))])]),t._v(" "),n("el-tag",{staticClass:"painfo",staticStyle:{width:"25%","font-family":"'微软雅黑'"},attrs:{color:"white"}},[t._v("就诊号: "),n("span",{staticStyle:{color:"black"}},[t._v(t._s(t.patient.medicalRecordNo))])]),t._v(" "),n("el-button",{staticStyle:{float:"right"},attrs:{type:"danger",plain:"",disabled:""}},[n("svg-icon",{attrs:{"icon-class":"skill"}}),t._v("退药")],1)],1),t._v(" "),n("el-table",{staticStyle:{"margin-left":"10px"},attrs:{height:"600px",border:"",stripe:"","highlight-current-row":"",data:t.druglistgiven}},[n("el-table-column",{attrs:{align:"center",label:"处方id"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.id)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"药品名",width:"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.drugName)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"单价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.price)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"总数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.num)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"已退药数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.refundNum)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center",label:"当前数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.currentNum)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{align:"center"}},[n("el-tag",{attrs:{type:"warning"}},[t._v("已取药")])],1),t._v(" "),n("el-table-column",{attrs:{align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(n){return t.refund(e.row)}}},[t._v("退药")])]}}])})],1)],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"选择退药数量",visible:t.refundVisible,width:"250px"},on:{"update:visible":function(e){t.refundVisible=e}}},[n("el-form",[n("el-form-item",{attrs:{label:"退药数量"}},[n("el-input",{staticStyle:{width:"100px"},attrs:{placeholder:""},model:{value:t.refundamout,callback:function(e){t.refundamout=e},expression:"refundamout"}})],1),t._v(" "),n("el-form-item",[n("el-button",{staticStyle:{float:"right"},attrs:{type:"danger"},on:{click:t.refundDrug}},[t._v("退药")])],1)],1)],1)],1)},a=[],s=(n("a450"),n("1bc7"),n("0a91")),r=n("ed08"),l=n("bf23"),o={data:function(){return{selectid:"",refundVisible:!1,refundamout:1,refundlimit:0,refundid:"",searchpatient:"",sendrefs:[],druglist:[],druglistgiven:[],patient:{},undoPatientList:[],donePatientList:[],visible:!1,isGiven:!1,spanArr:[],isaside:!0,activeName:"first",activeName2:"first",position:0}},created:function(){this.listPatient()},methods:{refundDrug:function(){var t=this;if(this.refundamout>this.refundlimit)this.$notify({title:"错误",message:"输入数量大于可退药数量！",type:"warning",duration:2e3});else if(this.refundamout<=0)this.$notify({title:"错误",message:"退药数量不能小于1！",type:"warning",duration:2e3});else{var e={};e.excutorId=this.$store.getters.id,e.refundItemList=[];var n={};n.refundNum=this.refundamout,n.refundPrescriptionItemId=this.refundid,n.type=5,e.refundItemList.push(n),Object(s["b"])(e).then((function(e){t.$notify({title:"成功",message:"退药成功",type:"success",duration:2e3}),t.refundVisible=!1,t.listPatient(),t.druglistgiven=[],t.handleGiven2()}))}},refund:function(t){this.refundVisible=!0,this.refundlimit=t.num-t.refundNum,this.refundid=t.drugid},sendDrug:function(){var t=this;this.sendrefs.forEach((function(e){Object(s["c"])(e.id,5).then((function(e){t.$notify({title:"成功",message:e.message,type:"success",duration:2e3}),t.listPatient(),t.druglist=[],t.druglistgiven=[]}))}))},changedep:function(t){console.log(t),this.sendrefs=t},rowspan:function(){var t=this;this.spanArr=[],this.position=0,this.druglist.forEach((function(e,n){0===n?(t.spanArr.push(1),t.position=0,e.sequence=n+1):t.druglist[n].id===t.druglist[n-1].id?(t.spanArr[t.position]+=1,t.spanArr.push(0),t.druglist[n].sequence=t.druglist[n-1].sequence):(t.spanArr.push(1),t.position=n,t.druglist[n].sequence=t.druglist[n-1].sequence+1)}))},objectSpanMethod:function(t){t.row,t.column;var e=t.rowIndex,n=t.columnIndex;if(0===n){var i=this.spanArr[e],a=i>0?1:0;return{rowspan:i,colspan:a}}if(1===n){var s=this.spanArr[e],r=s>0?1:0;return{rowspan:s,colspan:r}}},listPatient:function(){var t=this,e={};e.queryDate=Object(r["f"])(new Date),e.queryDate=e.queryDate.substr(0,10),e.type=5,Object(s["a"])(e).then((function(e){t.undoPatientList=e.data.undoPatientList,t.donePatientList=e.data.donePatientList}))},handleGive2:function(){var t=this;this.druglist=[],this.isGiven=!1;var e="";this.patient.prescriptionIdList.forEach((function(t){e+=t+","})),e=e.substr(0,e.length-1),Object(l["c"])(e).then((function(e){e.data.forEach((function(e){var n=e.id,i=e.name,a=e.createStaffName;e.dmsMedicineItemRecordResultList.forEach((function(e){e.drugid=e.id,e.id=n,e.doctorname=a,e.cname=i,t.druglist.push(Object(r["c"])(e))}))})),t.rowspan()}))},handleGive:function(t){var e=this;this.druglist=[],this.isGiven=!1,this.patient=Object(r["c"])(t);var n="";this.patient.prescriptionIdList.forEach((function(t){n+=t+","})),n=n.substr(0,n.length-1),Object(l["c"])(n).then((function(t){t.data.forEach((function(t){var n=t.id,i=t.name,a=t.createStaffName;t.dmsMedicineItemRecordResultList.forEach((function(t){t.drugid=t.id,t.id=n,t.doctorname=a,t.cname=i,e.druglist.push(Object(r["c"])(t))}))})),e.rowspan()}))},handleGiven2:function(){var t=this,e="";this.patient.prescriptionIdList.forEach((function(t){e+=t+","})),e=e.substr(0,e.length-1),Object(l["c"])(e).then((function(e){e.data.forEach((function(e){var n=e.id,i=e.name,a=e.createStaffName;e.dmsMedicineItemRecordResultList.forEach((function(e){e.drugid=e.id,e.id=n,e.doctorname=a,e.cname=i,t.druglistgiven.push(Object(r["c"])(e))}))}))}))},handleGiven:function(t){var e=this;this.isGiven=!0,this.druglistgiven=[],this.patient=Object(r["c"])(t);var n="";this.patient.prescriptionIdList.forEach((function(t){n+=t+","})),n=n.substr(0,n.length-1),Object(l["c"])(n).then((function(t){t.data.forEach((function(t){var n=t.id,i=t.name,a=t.createStaffName;t.dmsMedicineItemRecordResultList.forEach((function(t){t.drugid=t.id,t.id=n,t.doctorname=a,t.cname=i,e.druglistgiven.push(Object(r["c"])(t))}))}))}))},showaside:function(){this.isaside=!this.isaside},register:function(){this.$confirm("确定为 王小虎1 登记项目 验血 吗?","项目登记",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})}}},c=o,u=(n("591b"),n("cba8")),d=Object(u["a"])(c,i,a,!1,null,null,null);e["default"]=d.exports},"591b":function(t,e,n){"use strict";n("0fcc")},bf23:function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return l}));var i=n("b775");function a(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/apply",method:"post",data:t})}function s(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/listByReg",method:"post",params:{registrationId:t}})}function r(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/listByIds",method:"post",params:{ids:t}})}function l(t){return Object(i["a"])({url:"/DmsMedicinePrescriptionRecord/invalid",method:"post",params:{ids:t}})}}}]);